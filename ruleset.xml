<?xml version="1.0"?>
<ruleset name="omz13">
  <description>
    How omz13 likes code to look.
  </description>

  <!-- tabs -->
  <arg name="tab-width" value="2"/>

  <!-- see https://github.com/squizlabs/PHP_CodeSniffer/wiki/Customisable-Sniff-Properties#squizwhitespacefunctionspacing -->

  <!-- all generic -->
  <rule ref="Generic"/>

  <rule ref="Generic.Arrays.ArrayIndent">
    <properties>
      <property name="indent" value="2"/>
    </properties>
  </rule>

  <rule ref="Generic.Arrays.DisallowShortArraySyntax.Found">
    <exclude name="Generic.Arrays.DisallowShortArraySyntax.Found"/>
  </rule>

  <rule ref="Generic.Classes.OpeningBraceSameLine.BraceOnNewLine">
    <exclude name="Generic.Classes.OpeningBraceSameLine.BraceOnNewLine"/>
  </rule>

  <!-- if there is a todo, don't complain (fix it later!) -->
  <rule ref="Generic.Commenting.Todo.TaskFound">
    <exclude name="Generic.Commenting.Todo.TaskFound"/>
  </rule>

  <rule ref="Generic.Commenting.DocComment.MissingShort">
    <exclude name="Generic.Commenting.DocComment.MissingShort"/>
  </rule>

  <rule ref="Generic.Files.EndFileNoNewline.Found">
    <exclude name="Generic.Files.EndFileNoNewline.Found"/>
  </rule>

  <rule ref="Generic.Files.LineLength">
    <exclude name="Generic.Files.LineLength"/>
  </rule>

  <!-- <rule ref="Generic.Files.LineLength"> <properties> <property name="lineLimit" value="200"/> <property name="absoluteLineLimit" value="0"/> </properties> </rule> -->

  <rule ref="Generic.Functions.OpeningFunctionBraceKernighanRitchie">
    <properties>
      <property name="checkFunctions" value="true"/>
      <property name="checkClosures" value="true"/>
    </properties>
  </rule>

  <rule ref="Generic.Functions.OpeningFunctionBraceBsdAllman.BraceOnSameLine">
    <exclude name="Generic.Functions.OpeningFunctionBraceBsdAllman.BraceOnSameLine"/>
  </rule>

  <rule ref="Generic.PHP.ClosingPHPTag.NotFound">
    <exclude name="Generic.PHP.ClosingPHPTag.NotFound"/>
  </rule>

  <rule ref="Generic.PHP.UpperCaseConstant.Found">
    <exclude name="Generic.PHP.UpperCaseConstant.Found"/>
  </rule>

  <rule ref="Generic.WhiteSpace.DisallowSpaceIndent.SpacesUsed">
    <exclude name="Generic.WhiteSpace.DisallowSpaceIndent.SpacesUsed"/>
  </rule>

  <!-- my code is complex... deal with it -->
  <rule ref="Generic.Metrics.CyclomaticComplexity">
    <properties>
      <property name="complexity" value="18"/>
      <property name="absoluteComplexity" value="30"/>
    </properties>
  </rule>

  <rule ref="Generic.Metrics.NestingLevel">
    <properties>
      <property name="nestingLevel" value="8"/>
      <property name="absoluteNestingLevel" value="12"/>
    </properties>
  </rule>

  <rule ref="Generic.Strings.UnnecessaryStringConcat">
    <properties>
      <property name="allowMultiline" value="true"/>
    </properties>
  </rule>

  <!-- spaces around parens -->
  <rule ref="Generic.WhiteSpace.ArbitraryParenthesesSpacing">
    <properties>
      <property name="spacing" value="1"/>
      <property name="ignoreNewlines" value="true"/>
    </properties>
  </rule>

  <rule ref="Generic.WhiteSpace.ScopeIndent">
    <properties>
      <property name="indent" value="2"/>
      <property name="ignoreIndentationTokens" type="array" value="T_COMMENT,T_DOC_COMMENT_OPEN_TAG"/>
    </properties>
  </rule>

  <!--The complete PSR-2 ruleset-->
  <rule ref="PSR2"/>

  <rule ref="PSR2.Classes.ClassDeclaration">
    <properties>
      <property name="indent" value="2"/>
    </properties>
  </rule>

  <rule ref="PSR2.ControlStructures.ControlStructureSpacing">
    <properties>
      <property name="requiredSpacesAfterOpen" value="1"/>
      <property name="requiredSpacesBeforeClose" value="1"/>
    </properties>
  </rule>

  <rule ref="PSR2.ControlStructures.SwitchDeclaration">
    <properties>
      <property name="indent" value="2"/>
    </properties>
  </rule>

  <rule ref="PSR2.Methods.FunctionCallSignature">
    <properties>
      <property name="indent" value="4"/>
      <property name="allowMultipleArguments" value="false"/>
      <property name="requiredSpacesAfterOpen" value="1"/>
      <property name="requiredSpacesBeforeClose" value="1"/>
    </properties>
  </rule>

  <!-- let this be handled by SlevomatCodingStandard.Namespaces.NamespaceSpacing -->
  <rule ref="PSR2.Namespaces.NamespaceDeclaration.BlankLineAfter">
    <exclude name="PSR2.Namespaces.NamespaceDeclaration.BlankLineAfter"/>
  </rule>

  <!-- some of the squiz - adjusted accordingly to work with PSR2 as tweaked above -->

  <!-- Squiz.Operators.ComparisonOperatorUsage.NotAllowed -->
  <!-- Squiz.Operators.ComparisonOperatorUsage.ImplicitTrue -->
  <!-- Squiz.Commenting.InlineComment.NotCapital -->
  <!-- Squiz.Commenting.InlineComment.InvalidEndChar -->

  <rule ref="Squiz.Commenting.ClosingDeclarationComment"/>

  <rule ref="Squiz.Commenting.LongConditionClosingComment">
    <properties>
      <property name="lineLimit" value="14"/>
    </properties>
  </rule>

  <rule ref="Squiz.Functions.FunctionDeclarationArgumentSpacing">
    <properties>
      <property name="equalsSpacing" value="1"/>
      <property name="requiredSpacesAfterOpen" value="1"/>
      <property name="requiredSpacesBeforeClose" value="1"/>
    </properties>
  </rule>

  <rule ref="Squiz.Functions.MultiLineFunctionDeclaration.BraceOnSameLine">
    <exclude name="Squiz.Functions.MultiLineFunctionDeclaration.BraceOnSameLine"/>
  </rule>

  <rule ref="Squiz.ControlStructures.ForEachLoopDeclaration">
    <exclude name="Squiz.ControlStructures.ForEachLoopDeclaration"/>
  </rule>

  <rule ref="Squiz.ControlStructures.ForLoopDeclaration">
    <exclude name="Squiz.ControlStructures.ForLoopDeclaration"/>
  </rule>

  <rule ref="Squiz.Functions.FunctionDeclarationArgumentSpacing">
    <properties>
      <property name="equalsSpacing" value="1"/>
      <property name="requiredSpacesAfterOpen" value="1"/>
      <property name="requiredSpacesBeforeClose" value="1"/>
    </properties>
  </rule>

  <!-- Force whitespace before and after concatenation -->
  <rule ref="Squiz.Strings.ConcatenationSpacing">
    <properties>
      <property name="spacing" value="1"/>
      <property name="ignoreNewlines" value="true"/>
    </properties>
  </rule>

  <rule ref="Squiz.WhiteSpace.ControlStructureSpacing">
    <properties>
      <property name="requiredSpacesAfterOpen" value="1"/>
      <property name="requiredSpacesBeforeClose" value="1"/>
    </properties>
  </rule>

  <rule ref="Squiz.WhiteSpace.FunctionSpacing">
    <properties>
      <property name="spacing" value="1"/>
      <property name="spacingAfterLast" value="0"/>
    </properties>
  </rule>

  <rule ref="Squiz.WhiteSpace.LogicalOperatorSpacing"/>

  <rule ref="Squiz.WhiteSpace.MemberVarSpacing">
    <properties>
      <property name="spacing" value="0"/>
      <property name="spacingBeforeFirst" value="0"/>
    </properties>
  </rule>

  <rule ref="Squiz.WhiteSpace.OperatorSpacing">
    <properties>
      <property name="ignoreNewlines" value="true"/>
    </properties>
  </rule>

  <rule ref="Squiz.WhiteSpace.PropertyLabelSpacing"/>

  <rule ref="Squiz.WhiteSpace.SemicolonSpacing"/>

  <rule ref="Squiz.WhiteSpace.SuperfluousWhitespace"/>

  <!-- Some slevomat -->

  <rule ref="SlevomatCodingStandard.Exceptions.ReferenceThrowableOnly"/>
  <!-- <rule ref="SlevomatCodingStandard.TypeHints.DeclareStrictTypes"/> -->
  <rule ref="SlevomatCodingStandard.ControlStructures.AssignmentInCondition"/>
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.DisallowEmpty"/> -->
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.DisallowEqualOperators"/> -->

  <rule ref="SlevomatCodingStandard.ControlStructures.RequireNullCoalesceOperator"/>
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.EarlyExit"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Functions.StaticClosure"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Operators.DisallowIncrementAndDecrementOperators"/> -->
  <rule ref="SlevomatCodingStandard.Operators.RequireCombinedAssignmentOperator"/>
  <rule ref="SlevomatCodingStandard.Classes.UnusedPrivateElements"/>
  <rule ref="SlevomatCodingStandard.Functions.UnusedInheritedVariablePassedToClosure"/>
  <rule ref="SlevomatCodingStandard.Functions.UnusedParameter"/>
  <rule ref="SlevomatCodingStandard.Namespaces.UnusedUses"/>
  <rule ref="SlevomatCodingStandard.Namespaces.UseFromSameNamespace"/>
  <rule ref="SlevomatCodingStandard.Namespaces.UselessAlias"/>
  <rule ref="SlevomatCodingStandard.PHP.UselessParentheses"/>
  <rule ref="SlevomatCodingStandard.PHP.UselessSemicolon"/>
  <rule ref="SlevomatCodingStandard.Variables.UnusedVariable"/>
  <rule ref="SlevomatCodingStandard.Variables.UselessVariable"/>
  <rule ref="SlevomatCodingStandard.Exceptions.DeadCatch"/>
  <rule ref="SlevomatCodingStandard.Arrays.TrailingArrayComma"/>
  <rule ref="SlevomatCodingStandard.Classes.ModernClassNameReference"/>
  <rule ref="SlevomatCodingStandard.Classes.SuperfluousAbstractClassNaming"/>
  <rule ref="SlevomatCodingStandard.Classes.SuperfluousInterfaceNaming"/>
  <rule ref="SlevomatCodingStandard.Classes.TraitUseDeclaration"/>
  <rule ref="SlevomatCodingStandard.Classes.TraitUseSpacing">
    <properties>
      <property name="linesCountBeforeFirstUse" value="1"/>
      <property name="linesCountBetweenUses" value="0"/>
      <property name="linesCountAfterLastUse" value="1"/>
      <property name="linesCountAfterLastUseWhenLastInClass" value="0"/>
    </properties>
  </rule>
  <rule ref="SlevomatCodingStandard.ControlStructures.LanguageConstructWithParentheses"/>
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.NewWithParentheses"/> -->
  <rule ref="SlevomatCodingStandard.ControlStructures.NewWithoutParentheses"/>
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.DisallowShortTernaryOperator"/> -->
  <rule ref="SlevomatCodingStandard.ControlStructures.RequireShortTernaryOperator"/>
  <!-- <rule ref="SlevomatCodingStandard.ControlStructures.RequireYodaComparison"/> -->
  <rule ref="SlevomatCodingStandard.ControlStructures.DisallowYodaComparison"/>
  <rule ref="SlevomatCodingStandard.Namespaces.AlphabeticallySortedUses"/>
  <rule ref="SlevomatCodingStandard.Namespaces.RequireOneNamespaceInFile"/>
  <rule ref="SlevomatCodingStandard.Namespaces.NamespaceDeclaration"/>
  <rule ref="SlevomatCodingStandard.Namespaces.NamespaceSpacing">
    <properties>
      <property name="linesCountBeforeNamespace" value="1"/>
      <property name="linesCountAfterNamespace" value="1"/>
    </properties>
  </rule>
  <rule ref="SlevomatCodingStandard.Namespaces.UseSpacing">
    <properties>
      <property name="linesCountBeforeFirstUse" value="1"/>
      <property name="linesCountBetweenUseTypes" value="1"/>
      <property name="linesCountAfterLastUse" value="1"/>
    </properties>
  </rule>
  <!-- <rule ref="SlevomatCodingStandard.TypeHints.LongTypeHints"/> -->
  <!-- <rule ref="SlevomatCodingStandard.TypeHints.NullTypeHintOnLastPosition"/> -->
  <rule ref="SlevomatCodingStandard.PHP.ShortList"/>
  <rule ref="SlevomatCodingStandard.PHP.TypeCast"/>
  <!-- <rule ref="SlevomatCodingStandard.Files.TypeNameMatchesFileName"/> -->
  <rule ref="SlevomatCodingStandard.Classes.ClassConstantVisibility"/>
  <rule ref="SlevomatCodingStandard.TypeHints.ReturnTypeHintSpacing">
    <properties>
      <property name="spacesCountBeforeColon" value="1"/>
    </properties>
  </rule>

  <rule ref="SlevomatCodingStandard.TypeHints.NullableTypeForNullDefaultValue"/>
  <!-- <rule ref="SlevomatCodingStandard.TypeHints.ParameterTypeHintSpacing"/> -->
  <rule ref="SlevomatCodingStandard.Namespaces.DisallowGroupUse"/>
  <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedClassNameAfterKeyword"/>
  <!-- <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedExceptions"/> -->
  <!-- ??? <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedGlobalConstants"/> -->
  <!-- ??? <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedGlobalFunctions"/> -->
  <rule ref="SlevomatCodingStandard.Namespaces.MultipleUsesPerLine"/>
  <!-- <rule ref="SlevomatCodingStandard.Namespaces.ReferenceUsedNamesOnly"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Namespaces.UseOnlyWhitelistedNamespaces"/> -->
  <rule ref="SlevomatCodingStandard.Namespaces.UseDoesNotStartWithBackslash"/>
  <!-- <rule ref="SlevomatCodingStandard.Types.EmptyLinesAroundTypeBraces"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Namespaces.FullyQualifiedClassNameInAnnotation"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Commenting.ForbiddenAnnotations"/> -->
  <!-- <rule ref="SlevomatCodingStandard.Commenting.ForbiddenComments"/> -->
  <rule ref="SlevomatCodingStandard.Commenting.DocCommentSpacing">
    <properties>
      <property name="linesCountBeforeFirstContent" value="0"/>
      <property name="linesCountBetweenDescriptionAndAnnotations" value="1"/>
      <property name="linesCountBetweenDifferentAnnotationsTypes" value="1"/>
      <property name="linesCountAfterLastContent" value="0"/>
    </properties>
  </rule>
  <rule ref="SlevomatCodingStandard.Commenting.EmptyComment"/>
  <rule ref="SlevomatCodingStandard.Commenting.InlineDocCommentDeclaration"/>
  <rule ref="SlevomatCodingStandard.Commenting.RequireOneLinePropertyDocComment"/>
  <!-- <rule ref="SlevomatCodingStandard.Commenting.DisallowOneLinePropertyDocComment"/> -->
  <rule ref="SlevomatCodingStandard.Commenting.UselessInheritDocComment"/>


</ruleset>
